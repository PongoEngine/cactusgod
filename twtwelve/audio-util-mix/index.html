<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
     
    <meta name="author" content="Jeremy" />
     
    <meta name="description" content="Technical specifications of the forever 2012 album." />
     
    <meta property="og:title" content="Decoding the AUDIO_UTIL_mix function" />
    
    <meta property="og:site_name" content="Cactus God" />

    
    <meta property="og:image" content="" />
     <link rel="shortcut icon" href="/img/favicon.ico">  <link rel="alternate" href="/atom.xml" title="Cactus God" type="application/atom+xml"> 
    <title>Decoding the AUDIO_UTIL_mix function | Cactus God</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif&family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap"
      rel="stylesheet"
    />
    
    <style>
      body {
        background-color: #111;
        color: #fff;
      }

      header {
        background-color: #ed0044;
        color: #222;
      }

      code {
        background-color: #ffbfd1;
        color: #222;
      }

      figure {
        background-color: #ffbfd1;
        color: #222;
      }

      .arrangement {
        border: 1px solid #ff80a4;
      }

      .arrangement-wavy {
        stroke: #ed0044;
      }

      .tubs-segment {
        fill: #444;
        stroke: #000;
      }

      .tubs-segment.down {
        stroke: #888;
        stroke-width: 3px;
      }

      .tubs-segment.back {
        stroke: #888;
        stroke-width: 2px;
      }

      .tubs-segment.split {
        stroke: #888;
        stroke-width: 1px;
      }

      .tubs-segment.hit {
        fill: #ed0044;
      }

      .tubs-line {
        stroke: #ff80a4;
      }

      .tubs-text {
        fill: #fff;
      }

      .tubs-backing-cur {
        stroke: #ff80a4;
      }

      .tubs-text-cur {
        fill: #fff;
      }

      .dyn-pattern-path {
        stroke: #ed0044;
      }

      .dyn-text {
        fill: #000;
      }

      .dyn-dynamics {
        fill: none;
        stroke: #ed0044;
      }

      .dyn-point-tri {
        fill: none;
        stroke: #ed0044;
      }

      .dyn-point-text {
        fill: #fff;
      }
    </style>
  
    
<link rel="stylesheet" href="/css/blog.css">

  <meta name="generator" content="Hexo 5.4.0"></head>
  <body>
    <div class="container">
      <header>
  <ul class="blog-nav">
    
    <li class="blog-nav-item">
      <a href="/">Home</a>
    </li>
    
    <li class="blog-nav-item">
      <a href="/about">About</a>
    </li>
    
  </ul>
  <h1>
    <span class="header-title">Cactus God</span
    >
  </h1>
  <div class="header-line"></div>
</header>
 
      <div class="post">
  <!-- Title -->
  <h1>
    
      Decoding the AUDIO_UTIL_mix function
    
  </h1>
  <p class="post-date">
    July 11, 2023
  </p>
  
    
    <svg version="1.1"
    width="4300" viewBox="0 0 4300 1642.4485930827002"
    class="dynamics"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs>
        <pattern id="pattern-2" x="0" y="0" width="120" height="20" patternUnits="userSpaceOnUse">
          <path stroke-width="1.458971001038043" class="dyn-pattern-path" d='M-50.129 12.685C-33.346 12.358-16.786 4.918 0 5c16.787.082 43.213 10 60 10s43.213-9.918 60-10c16.786-.082 33.346 7.358 50.129 7.685' stroke-width='0.5' stroke='rgb(0, 0, 0)' fill='none' />
        </pattern>
      </defs>
      <rect class="dyn-rect-back" width="4300" height="1642.4485930827002" x="0" y="0" fill="url(#pattern-2)" />
      <rect class="dyn-rect-front" width="4300" height="1642.4485930827002" x="239.62848680033926" y="239.62848680033926" fill="url(#pattern-2)" />
      <text class="dyn-text no-user-select" font-weight="700" letter-spacing="-13.353909694469854" font-size="299.5356085004241" alignment-baseline="hanging" text-anchor="middle" x="2150" y="821.2242965413501">NEEDS TO PREVENT CLIPPING</text>
      
      <polyline class="dyn-dynamics" points="0,1478.2037337744302 102.38095238095238,1478.2037337744302 204.76190476190476,1313.95887446616 307.1428571428571,1313.95887446616 409.5238095238095,1478.2037337744302 511.9047619047619,1478.2037337744302 614.2857142857143,1313.95887446616 716.6666666666667,1313.95887446616 819.0476190476192,1149.7140151578901 921.4285714285716,1149.7140151578901 1023.809523809524,1478.2037337744302 1126.1904761904764,1478.2037337744302 1126.1904761904764,164.24485930826995 1228.5714285714287,164.24485930826995 1330.952380952381,164.24485930826995 1433.3333333333333,164.24485930826995 1535.7142857142856,164.24485930826995 1638.0952380952378,164.24485930826995 1740.4761904761901,164.24485930826995 1842.8571428571424,164.24485930826995 1945.2380952380947,164.24485930826995 2047.619047619047,164.24485930826995 2149.9999999999995,164.24485930826995 2252.380952380952,164.24485930826995 2354.761904761904,164.24485930826995 2457.1428571428564,164.24485930826995 2559.5238095238087,164.24485930826995 2661.904761904761,164.24485930826995 2764.2857142857133,164.24485930826995 2764.2857142857133,1149.7140151578901 2866.6666666666656,1149.7140151578901 2969.047619047618,1313.95887446616 3071.42857142857,1313.95887446616 3173.8095238095225,1478.2037337744302 3276.190476190475,1478.2037337744302 3378.571428571427,1478.2037337744302 3378.571428571427,1313.95887446616 3480.9523809523794,1313.95887446616 3583.3333333333317,1149.7140151578901 3685.714285714284,1149.7140151578901 3788.0952380952363,1313.95887446616 3890.4761904761885,1313.95887446616 3992.857142857141,1478.2037337744302 4095.238095238093,1478.2037337744302 4095.238095238093,164.24485930826995 4197.619047619046,164.24485930826995 4299.999999999998,164.24485930826995 " stroke-width="5" />
    </svg>

<p>Racing simulators hinge on immersive experiences and achieving quality sound plays a significant role. The crux lies in accurately blending multiple audio signals without distortion or clipping - a consequence of exceeding the system’s maximum limit.</p>
<span id="more"></span>

<p>The solution emerges in the AUDIO_UTIL_mix function. It effortlessly combines signals, curbs clipping, and maintains signal integrity, crucial for authentically reproducing sounds like the fluctuating car suspension heights during a virtual race.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">AUDIO_UTIL_mix</span><span class="params">(<span class="keyword">float</span> a, <span class="keyword">float</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (a + b) - a * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>Given <code>a</code> and <code>b</code> as the two signals, the values of <code>a</code> and <code>b</code> always lie within the range [0,1].</p>
<h2 id="Preventing-Clipping"><a href="#Preventing-Clipping" class="headerlink" title="Preventing Clipping"></a>Preventing Clipping</h2><p>In traditional signal mixing, when you simply add together two signals (for example, <code>a + b</code>), it might result in a value that exceeds 1. This is what leads to the dreaded clipping effect. </p>
<p>The AUDIO_UTIL_mix function avoids this issue by subtracting the product of <code>a</code> and <code>b</code> from their sum (<code>a + b - a * b</code>). The mathematical range for this operation is always [0,1] as long as the inputs <code>a</code> and <code>b</code> are within [0,1]. Here’s why:</p>
<ul>
<li>At the maximum, when <code>a</code> and <code>b</code> are both 1, the output of the function is <code>1 + 1 - 1 * 1 = 1</code>.</li>
<li>At the minimum, when <code>a</code> and <code>b</code> are both 0, the output is <code>0 + 0 - 0 * 0 = 0</code>.</li>
</ul>
<p>So, regardless of the input values, the result always stays within the allowable signal range, thus successfully preventing clipping.</p>
<h2 id="Signal-Preservation"><a href="#Signal-Preservation" class="headerlink" title="Signal Preservation"></a>Signal Preservation</h2><p>A well-designed audio mixing function not only needs to prevent clipping but also ensure that the essence of each individual signal is maintained in the mixed output. Let’s see how the AUDIO_UTIL_mix function handles this:</p>
<p>The component <code>(a * b)</code> in the equation can be interpreted as the ‘interaction’ between the two signals. As <code>a</code> or <code>b</code> gets closer to 0, the interaction term reduces thus making the combined signal closer to a linear sum of the two individual signals ensuring that the nature of the quieter signal is retained. On the other hand, as <code>a</code> or <code>b</code> approaches 1 the interaction becomes more significant which helps to maintain the overall amplitude limit without a significant loss of signal characteristics.</p>

  
</div>

<ul class="pager">
  
      <li class="pager-left"><a href="https://cactusgod.com/twtwelve/tuning-road-noise/">↩ Tuning Into the Symphony of Road Noise</a></li>
  
  
</ul> 
      <footer>
    &#169; 2021 Cactus God | Jeremy
</footer>
    </div>
    
<script src="/js/script.js"></script>

  </body>
</html>
